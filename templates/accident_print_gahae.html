<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>교통사고보고서 (가해)</title>
    <style>
        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background-color: #f0f0f0; }
        .report-container {
            width: 794px; /* A4 portrait width at 96 DPI */
            height: 1123px; /* A4 portrait height at 96 DPI */
            margin: 20px auto;
            padding: 40px;
            background: #fff;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        th, td { border: 1px solid #000; padding: 4px 6px; font-size: 14px; }
        th { background: #f0f0f0; }
        .section-title { text-align: center; font-size: 22px; font-weight: bold; padding: 10px 0; }
        .map, .desc { display: inline-block; vertical-align: top; }
        .map { width: 55%; border: 1px solid #000; height: 220px; }
        .desc { width: 44%; border: 1px solid #000; height: 220px; }
        .footer-table th, .footer-table td { font-size: 13px; }
        @media print {
            body > :not(.report-container) {
                display: none;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .report-container {
                box-shadow: none;
                margin: 0;
                width: 100%;
                border: none;
                height: auto;
                padding: 0;
            }
        }
    </style>
</head>
<body>
<div class="report-container">
    <table style="height:80px;">
        <tr>
            <!-- <th rowspan="2" style="width:12%;">접수번호</th> -->
            <th colspan="5" class="section-title">교 통 사 고 보 고 서 (가해)</th>
            <th rowspan="2" style="width:8%;">결<br>재</th>
        
            <td style="width:8%; text-align:center;" >담당<hr><br><br></td>
            <td style="width:8%; text-align:center;">상무<hr><br><br></td>
            <td style="width:8%; text-align:center;">부사장<hr><br><br></td>
            <td style="width:8%; text-align:center;">대표<hr><br><br></td>
        </tr>
    </table>
    <table>
        <tr>
            <th>사고일시</th>
            <td style="width:20%;">{{ accident.사고일시 or '' }}</td>
            <th>차량번호</th>
            <td style="width:20%;">{{ accident.차번 or '' }}</td>
            <th>차종</th>
            <td style="width:20%;">{{ accident.차종 or '' }}</td>
        </tr>
        <tr>
            <th>사고장소</th>
            <td colspan="3">{{ accident.사고장소 or '' }}</td>
            <th>사고원인</th>
            <td colspan="1">{{ accident.사고원인 or '' }}</td>
        </tr>
        <tr>
            <th>기사명</th>
            <td>{{ accident.기사명 or '' }}</td>
            <th>주민번호</th>
            <td>{{ accident.주민등록번호 or '' }}</td>
            <th>연락처</th>
            <td>{{ accident.연락처 or '' }}</td>
        </tr>
        <tr>
            <th>사번</th>
            <td>{{ accident.사번 or '' }}</td>
            <th>면허번호</th>
            <td>{{ accident.면허번호 or '' }}</td>
            <th>유효기간</th>
            <td>{{ accident.갱신마감.split(' ')[0] if accident.갱신마감 else '' }}</td>
        </tr>
        <tr>
            <th>거주지</th>
            <td colspan="3">{{ accident.거주지 or '' }}</td>
            <th>입사일자</th>
            <td colspan="1">{{ accident.입사일자.split(' ')[0] if accident.입사일자 else '' }}</td>
        </tr>
        </table>
        <table>
        <tr>
            <tr>
                <th colspan="4" style="width:100%;">보상내역 / 가해현황</th>
            </tr>
            <th style="width:20%;">접보사항</th>
            <td style="width:30%;">{{ accident.접보사항 or '' }}</td>
            <th style="width:20%;">접수번호</th>
            <td style="width:30%;">{{ accident.접수번호 or '' }}</td>          
        </tr>
        <tr>
            <th>담당자</th>
            <td>{{ accident.담당자 or '' }}</td>
            <th>연결번호</th>
            <td>{{ accident.연결번호 or '' }}</td>
        </tr>
        </table>
        <table>
        <tr>
            <tr>
                <th colspan="4" style="width:100%;">대인</th>
            </tr>
            <th style="width:20%;">피해자</th>
            <td style="width:30%;">{{ accident.피해자 or '' }}</td>
            <th style="width:20%;">연락처</th>
            <td style="width:30%;">{{ accident.피해자연락처 or '' }}</td>
        </tr>
        <tr>
            <th>병원</th>
            <td>{{ accident.병원 or '' }}</td>
            <th>병원연락처</th>
            <td>{{ accident.병원연락처 or '' }}</td>
        </tr>
        <tr>
            <th>치료견적</th>
            <td>{{ "{:,}".format(accident.치료견적|int) if accident.치료견적 and accident.치료견적.replace(',', '').isdigit() else accident.치료견적 or '' }}</td>
            <th>상해</th>
            <td>{{ accident.상해 or '' }}</td>
        </tr>
        </table>
        <table>
        <tr>
            <tr>
                <th colspan="4" style="width:100%;">대물</th>
            </tr>
            <th style="width:20%;">피해차번</th>
            <td style="width:30%;">{{ accident.피해차번 or '' }}</td>
            <th style="width:20%;">피해차종</th>
            <td style="width:30%;">{{ accident.피해차종 or '' }}</td>
        </tr>
        <tr>
            <th>운전자</th>
            <td>{{ accident.운전자 or '' }}</td>
            <th>연락처</th>
            <td>{{ accident.운전자연락처 or '' }}</td>
        </tr>
        <tr>
            <th>공업사</th>
            <td>{{ accident.공업사 or '' }}</td>
            <th>공업사연락처</th>
            <td>{{ accident.공업사연락처 or '' }}</td>
        </tr>
        <tr>
            <th>견적금액</th>
            <td>{{ "{:,}".format(accident.수리추산|int) if accident.수리추산 and accident.수리추산.replace(',', '').isdigit() else accident.수리추산 or '' }}</td>
            <th>비고</th>
            <td>{{ accident.비고 or '' }}</td>
        </tr>
    </table>
    <div style="display: flex; margin-top: 10px;">
        <div class="map" style="width: 50%; height: 300px; padding: 10px;">
            사고 현장 약도<br>
            <img src="/uploads/maps/{{ accident.사고번호 }}.png" alt="사고 현장 약도" style="width:100%;max-height: 300px; margin-top: 10px;">
        </div>
        <div class="desc" style="width: 50%; height: 300px; padding: 10px;">사고 경위<br><br>
            {{ accident.사고경위 or '' }}
            <!-- 필요시 accident.description 등 추가 -->
        </div>
    </div>
    <table class="footer-table" style="margin-top:10px; text-align:center;">
        <tr>
            <th>경찰서</th>
            <th>조사관</th>
            <th>접보사항</th>
            <th>담당자</th>
            <th>연결번호</th>
            <th>사고번호</th>
        </tr>
        <tr>
            <td>{{ accident.경찰서 or '' }}</td>
            <td>{{ accident.조사관 or '' }}</td>
            <td>{{ accident.접보사항 or '' }}</td>
            <td>{{ accident.담당자 or '' }}</td>
            <td>{{ accident.연결번호 or '' }}</td>
            <td style="font-size: 20px; font-weight: bold; text-align: center;">{{ accident.사고번호 }}</td>
        </tr>
    </table>
</div>
<div style="text-align:center; margin:20px;">
    <button onclick="window.open('/map?version={{ accident.사고번호|lower }}', '_blank')" style="padding:8px 24px; font-size:15px; background:#4CAF50; color:#fff; border:none; border-radius:5px; cursor:pointer;">약도 제작/편집</button>
    <button onclick="window.print()" style="padding:8px 24px; font-size:15px; background:#4CAF50; color:#fff; border:none; border-radius:5px; cursor:pointer;">프린트하기</button>
</div>
<script>
    // window.onload = function() { window.print(); }
</script>
</body>
</html> 